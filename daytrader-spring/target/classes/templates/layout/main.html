<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title layout:title-pattern="$CONTENT_TITLE - DayTrader">DayTrader</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script th:src="@{/js/htmx.min.js}"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="navbar-brand">
                <a th:href="@{/tradehome}">DayTrader</a>
            </div>
            <div class="navbar-menu" sec:authorize="isAuthenticated()">
                <a th:href="@{/tradehome}" class="nav-link">Home</a>
                <a th:href="@{/portfolio}" class="nav-link">Portfolio</a>
                <a th:href="@{/quote}" class="nav-link">Quotes</a>
                <a th:href="@{/account}" class="nav-link">Account</a>
                <a th:href="@{/config}" class="nav-link" sec:authorize="hasRole('ADMIN')">Config</a>
                <form th:action="@{/logout}" method="post" style="display:inline">
                    <button type="submit" class="nav-link btn-link">Logout
                        (<span sec:authentication="name">User</span>)
                    </button>
                </form>
            </div>
        </nav>
    </header>

    <main class="container">
        <!-- Market Summary (HTMX auto-refresh) -->
        <div sec:authorize="isAuthenticated()"
             hx-get="/marketsummary" hx-trigger="load, every 20s" hx-swap="innerHTML"
             class="market-summary-container">
        </div>

        <!-- Flash messages -->
        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>
        <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>
        <div th:if="${successMsg}" class="alert alert-success" th:text="${successMsg}"></div>

        <!-- Page content -->
        <div layout:fragment="content"></div>
    </main>

    <footer>
        <p>DayTrader Spring Boot - Stock Trading Benchmark</p>
    </footer>

    <div layout:fragment="scripts"></div>
</body>
</html>
