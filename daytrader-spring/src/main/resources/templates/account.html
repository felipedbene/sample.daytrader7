<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>Account</title>
</head>
<body>
<div layout:fragment="content">
    <h2>Account Details</h2>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Account Information</span>
        </div>
        <table class="data-table">
            <tr><th>Account ID</th><td th:text="${account.accountID}">0</td></tr>
            <tr><th>Created</th><td th:text="${#temporals.format(account.creationDate, 'MMM dd, yyyy h:mm a')}">-</td></tr>
            <tr><th>Last Login</th><td th:text="${account.lastLogin != null ? #temporals.format(account.lastLogin, 'MMM dd, yyyy h:mm a') : '-'}">-</td></tr>
            <tr><th>Total Logins</th><td th:text="${#numbers.formatInteger(account.loginCount, 1, 'COMMA')}">0</td></tr>
            <tr><th>Total Logouts</th><td th:text="${#numbers.formatInteger(account.logoutCount, 1, 'COMMA')}">0</td></tr>
            <tr><th>Open Balance</th><td th:text="'$' + ${#numbers.formatDecimal(account.openBalance, 1, 'COMMA', 2, 'POINT')}">$0.00</td></tr>
            <tr><th>Current Balance</th><td th:text="'$' + ${#numbers.formatDecimal(account.balance, 1, 'COMMA', 2, 'POINT')}">$0.00</td></tr>
            <tr>
                <th>Gain/Loss</th>
                <td th:class="${gain.doubleValue() >= 0 ? 'positive' : 'negative'}"
                    th:text="'$' + ${#numbers.formatDecimal(gain, 1, 'COMMA', 2, 'POINT')} + ' (' + ${#numbers.formatDecimal(gainPercent, 1, 'COMMA', 2, 'POINT')} + '%)'">$0.00</td>
            </tr>
        </table>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Update Profile</span>
        </div>
        <form th:action="@{/account/update}" method="post">
            <div class="form-group">
                <label for="fullName">Full Name</label>
                <input type="text" id="fullName" name="fullName" th:value="${profile.fullName}">
            </div>
            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" id="address" name="address" th:value="${profile.address}">
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" th:value="${profile.email}">
            </div>
            <div class="form-group">
                <label for="creditCard">Credit Card</label>
                <input type="text" id="creditCard" name="creditCard" th:value="${profile.creditCard}">
            </div>
            <div class="form-group">
                <label for="password">New Password (leave blank to keep current)</label>
                <input type="password" id="password" name="password">
            </div>
            <button type="submit" class="btn btn-primary">Update Profile</button>
        </form>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Order History</span>
        </div>
        <div th:if="${#lists.isEmpty(orders)}">
            <p style="color: var(--text-muted);">No orders yet.</p>
        </div>
        <table th:if="${!#lists.isEmpty(orders)}" class="data-table">
            <thead>
                <tr>
                    <th>Order ID</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Symbol</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Fee</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="order : ${orders}">
                    <td th:text="${order.orderID}">0</td>
                    <td th:class="${order.orderType == 'buy' ? 'positive' : 'negative'}"
                        th:text="${order.orderType}">buy</td>
                    <td th:text="${order.orderStatus}">open</td>
                    <td th:text="${order.symbol}">s:0</td>
                    <td th:text="${#numbers.formatInteger(order.quantity, 1, 'COMMA')}">0</td>
                    <td th:text="'$' + ${#numbers.formatDecimal(order.price, 1, 'COMMA', 2, 'POINT')}">$0.00</td>
                    <td th:text="'$' + ${#numbers.formatDecimal(order.orderFee, 1, 'COMMA', 2, 'POINT')}">$0.00</td>
                    <td th:text="${#temporals.format(order.openDate, 'MMM dd, yyyy h:mm a')}">-</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
